---
    - file: path=/etc/kubernetes/ssl state=directory
    - file: path=/etc/flannel state=directory
    - file: path=/etc/systemd/system/flanneld.service.d state=directory
    - file: path=/etc/systemd/system/docker.service.d state=directory
    - file: path=/etc/kubernetes/manifests state=directory
    - name: copy ssl certs
      copy: src=/Users/rajeshwerrao/kubrnetes/core/certs/ dest=/etc/kubernetes/ssl
    - name: install options.env 
      template: 
        src=options.env dest=/etc/flannel
      notify: daemon-reload
    - name: install 40-ExecStartPre-symlink.conf
      copy: 
        src=40-ExecStartPre-symlink.conf dest=/etc/systemd/system/flanneld.service.d/
      notify: daemon-reload
    - name: install 40-flannel.conf
      copy: 
        src=40-flannel.conf dest=/etc/systemd/system/docker.service.d/
      notify: daemon-reload
    - name: create kubelet unit
      template:
         src=kubelet.service dest=/etc/systemd/system/
    - name: config kube-apiserver
      template: src=kube-apiserver.yaml dest=/etc/kubernetes/manifests/kube-apiserver.yaml
    - name: config kube-proxy
      template: src=kube-proxy.yaml dest=/etc/kubernetes/manifests/
    - name: config kube-controller-manager
      template: src=kube-controller-manager.yaml dest=/etc/kubernetes/manifests/
    - name: config kube-scheduler.yaml
      template: src=kube-scheduler.yaml dest=/etc/kubernetes/manifests/
    - name: ensure flanneld is running
      service: name=flanneld state=started
    - name: ensure flanneld is running
      service: name=flanneld state=enabled
